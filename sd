#!/usr/bin/env sh

# Node 22+ supports native TypeScript via --experimental-strip-types.
# Node 20 and below use the build artifacts via pnpm run s.
# Note: This doesn't rebuild - use `pnpm run build` first if you changed code.

NODE_MAJOR=$(node -v | cut -d'v' -f2 | cut -d'.' -f1)

if [ "$NODE_MAJOR" -lt 22 ]; then
  # Node 20 or older - use built artifacts.
  pnpm --filter @socketsecurity/cli run s -- "$@"
else
  # Node 22+ - use native TypeScript support.
  cd "$(dirname "$0")" && node --experimental-strip-types --no-warnings packages/cli/src/cli.mts "$@"
fi
